# scripts/malware_scanner_stub.py

import os
import hashlib
from datetime import datetime

# Example: List of known malicious MD5 hashes (you can expand this!)
KNOWN_BAD_HASHES = [
    "44d88612fea8a8f36de82e1278abb02f",  # EICAR test file
    # Add more hashes as needed
]

def calculate_md5(file_path):
    hash_md5 = hashlib.md5()
    try:
        with open(file_path, "rb") as f:
            for chunk in iter(lambda: f.read(4096), b""):
                hash_md5.update(chunk)
        return hash_md5.hexdigest()
    except Exception as e:
        return None

def scan_directory(directory):
    output_file = "malware_scan_report.txt"
    with open(output_file, "w") as report:
        report.write(f"Malware Scan Report - {datetime.now()}\n")
        report.write(f"Scanned directory: {directory}\n\n")
        for root, dirs, files in os.walk(directory):
            for file in files:
                file_path = os.path.join(root, file)
                md5 = calculate_md5(file_path)
                if md5 and md5 in KNOWN_BAD_HASHES:
                    report.write(f"[MALWARE FOUND] {file_path} (MD5: {md5})\n")
        report.write("\nScan complete.\n")
    print(f"Scan complete. Report saved to {output_file}")

if __name__ == "__main__":
    directory_to_scan = input("Enter the path to scan (e.g., C:\\Users\\sahil vats\\Desktop): ")
    scan_directory(directory_to_scan)
